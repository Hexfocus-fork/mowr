{% extends "admin/layout.html" %}
{% block content %}
    <!-- top tiles -->
    <div class="row tile_count">
        <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
            <div class="left"></div>
            <div class="right">
                <span class="count_top"><i class="fa fa-file"></i> Total Samples</span>
                <div class="count">{{ '{:,d}'.format(stats.get('samples').get('nb')) }}</div>
                <span class="count_bottom">All types</span>
            </div>
        </div>
        <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
            <div class="left"></div>
            <div class="right">
                <span class="count_top"><i class="fa fa-file"></i> Malicious ratio</span>
                <canvas style="width: 94px; display: block; margin-left: -10px; margin-right: -30px;"
                        id="gaugeClean"></canvas>
                <span class="count_bottom">
                <span id="gauge-text">{{ stats.get('samples').get('malicious') }}</span>
                <span id="goal-text"
                      style="margin-left: 62px;">{{ stats.get('samples').get('clean') }}</span>
                </span>
            </div>
        </div>
        <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
            <div class="left"></div>
            <div class="right">
                <span class="count_top"><i class="fa fa-user"></i> None</span>
                <div class="count green">0</div>
                <span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i>34% </i> From last Week</span>
            </div>
        </div>
        <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
            <div class="left"></div>
            <div class="right">
                <span class="count_top"><i class="fa fa-user"></i> None</span>
                <div class="count">0</div>
                <span class="count_bottom"><i class="red"><i class="fa fa-sort-desc"></i>12% </i> From last Week</span>
            </div>
        </div>
        <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
            <div class="left"></div>
            <div class="right">
                <span class="count_top"><i class="fa fa-user"></i> None</span>
                <div class="count">0</div>
                <span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i>34% </i> From last Week</span>
            </div>
        </div>
        <div class="animated flipInY col-md-2 col-sm-4 col-xs-4 tile_stats_count">
            <div class="left"></div>
            <div class="right">
                <span class="count_top"><i class="fa fa-user"></i> None</span>
                <div class="count">0</div>
                <span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i>34% </i> From last Week</span>
            </div>
        </div>

    </div>
    <!-- /top tiles -->

    <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Line graph
                        <small>Sessions</small>
                    </h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <canvas id="samplesChart" height="75px"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- graphs -->
    <div class="row">
        <div class="col-md-4 col-sm-6 col-xs-12">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Disk usage
                        <small>(in bytes)</small>
                    </h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <canvas id="diskUsage"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-4 col-sm-6 col-xs-12">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Most uploaded file type
                        <small></small>
                    </h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <canvas id="fileType"></canvas>
                </div>
            </div>
        </div>
    </div>
    <!-- /graphs -->
{% endblock %}
{% block script %}
    <script>
        var ctx;
        var data;

        // Gauge
        var opts = {
            lines: 12, // The number of lines to draw
            angle: 0, // The length of each line
            lineWidth: 0.4, // The line thickness
            pointer: {
                length: 0.75, // The radius of the inner circle
                strokeWidth: 0.042, // The rotation offset
                color: '#1D212A' // Fill color
            },
            limitMax: 'false', // If true, the pointer will not go past the end of the gauge
            colorStart: '#DF013A', // Colors
            colorStop: '#DF013A', // just experiment with them
            strokeColor: '#1ABC9C', // to see which ones work best for you
            generateGradient: false
        };
        var target = document.getElementById('gaugeClean'); // your canvas element
        var gauge = new Gauge(target).setOptions(opts); // create sexy gauge!
        gauge.maxValue = {{ stats.get('samples').get('nb') }}; // set max gauge value
        gauge.animationSpeed = 32; // set animation speed (32 is default value)
        gauge.set({{ stats.get('samples').get('malicious') }}); // set actual value
        gauge.setTextField(document.getElementById("gauge-text"));

        // Main graph
        ctx = document.getElementById("samplesChart");
        var lineChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: {{ stats.get('samplesChart').get('dateList')|safe }},
                datasets: [{
                    label: "Uploaded files",
                    backgroundColor: "rgba(38, 185, 154, 0.31)",
                    borderColor: "rgba(38, 185, 154, 0.7)",
                    pointBorderColor: "rgba(38, 185, 154, 0.7)",
                    pointBackgroundColor: "rgba(38, 185, 154, 0.7)",
                    pointHoverBackgroundColor: "#fff",
                    pointHoverBorderColor: "rgba(220,220,220,1)",
                    pointBorderWidth: 1,
                    data: {{ stats.get('samplesChart').get('data1') }}
                }]
            }
        });

        // Disk usage
        ctx = document.getElementById("diskUsage");
        data = {
            datasets: [{
                data: [{{ stats.get('diskUsage').get('remaining_storage') }}, {{ stats.get('diskUsage').get('file_size') }}],
                backgroundColor: [
                    "#BDC3C7",
                    "#26B99A"
                ],
                label: 'Disk usage' // for legend
            }],
            labels: [
                "Remaining space",
                "Used space"
            ]
        };

        var diskUsage = new Chart(ctx, {
            data: data,
            type: 'pie',
            otpions: {
                legend: true
            }
        });

        // File type
        ctx = document.getElementById("fileType");
        data = {
            datasets: [{
                data: {{ stats.get('fileType').get('stats') }},
                backgroundColor: [
                    "#9B59B6",
                    "#BDC3C7",
                    "#26B99A",
                    "#3498DB",
                    "#455C73"
                ],
                label: 'File types' // for legend
            }],
            labels: {{ stats.get('fileType').get('types')|safe }}
        };

        var fileType = new Chart(ctx, {
            data: data,
            type: 'pie',
            otpions: {
                legend: true
            }
        });
    </script>
{% endblock %}